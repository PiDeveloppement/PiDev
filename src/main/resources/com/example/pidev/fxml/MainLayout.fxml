<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<?import javafx.scene.text.*?>

<StackPane prefHeight="900" prefWidth="1400"
           xmlns="http://javafx.com/javafx/17"
           xmlns:fx="http://javafx.com/fxml/1"
           fx:controller="com.example.pidev.MainController"
           stylesheets="@/com/example/pidev/css/atlantafx-custom.css">

    <HBox alignment="TOP_LEFT">

        <!-- SIDEBAR -->
        <VBox prefWidth="285" minWidth="285" maxWidth="285"
              styleClass="sidebar-root" VBox.vgrow="ALWAYS">

            <!-- Logo -->
            <VBox alignment="CENTER" spacing="6" styleClass="sidebar-logo">
                <ImageView fitHeight="125" fitWidth="110" preserveRatio="true">
                    <Image url="@/com/example/pidev/icons/logo.png"/>
                </ImageView>
                <Label styleClass="sidebar-appname" text="EventFlow"/>
                <Label styleClass="sidebar-appsubtitle" text="Gestion Ã‰vÃ©nements"/>
            </VBox>

            <!-- Menu -->
            <ScrollPane fitToWidth="true" vbarPolicy="NEVER" hbarPolicy="NEVER"
                        styleClass="sidebar-scroll" VBox.vgrow="ALWAYS">
                <content>
                    <VBox spacing="10" styleClass="sidebar-menu">

                        <!-- Dashboard -->
                        <Button fx:id="dashboardBtn" text="Dashboard"
                                styleClass="main-menu-button"
                                onAction="#onDashboard" maxWidth="1.7976931348623157E308">
                            <graphic><Text styleClass="menu-icon" text="â–¦"/></graphic>
                        </Button>

                        <!-- Ã‰vÃ©nements -->
                        <VBox spacing="6">
                            <Button fx:id="eventsToggleBtn" text="Ã‰vÃ©nements"
                                    styleClass="main-menu-button"
                                    onAction="#toggleEvents" maxWidth="1.7976931348623157E308">
                                <graphic>
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Text styleClass="menu-icon" text="ðŸ—“"/>
                                        <Text fx:id="eventsArrow" styleClass="menu-arrow" text="â–¶"/>
                                    </HBox>
                                </graphic>
                            </Button>

                            <VBox fx:id="eventsSubmenu" visible="false" managed="false" spacing="6">
                                <Button fx:id="eventsListBtn" text="   Liste Ã©vÃ©nements"
                                        styleClass="submenu-button" onAction="#onEventsList"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="categoriesBtn" text="   CatÃ©gories"
                                        styleClass="submenu-button" onAction="#onCategories"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="ticketsBtn" text="   Billets"
                                        styleClass="submenu-button" onAction="#onTickets"
                                        maxWidth="1.7976931348623157E308"/>
                            </VBox>
                        </VBox>

                        <!-- Participants -->
                        <VBox spacing="6">
                            <Button fx:id="usersToggleBtn" text="Participants"
                                    styleClass="main-menu-button"
                                    onAction="#toggleUsers" maxWidth="1.7976931348623157E308">
                                <graphic>
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Text styleClass="menu-icon" text="ðŸ‘¥"/>
                                        <Text fx:id="usersArrow" styleClass="menu-arrow" text="â–¶"/>
                                    </HBox>
                                </graphic>
                            </Button>

                            <VBox fx:id="usersSubmenu" visible="false" managed="false" spacing="6">
                                <Button fx:id="rolesBtn" text="   RÃ´les"
                                        styleClass="submenu-button" onAction="#onRoles"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="inscriptionsBtn" text="   Inscriptions"
                                        styleClass="submenu-button" onAction="#onInscriptions"
                                        maxWidth="1.7976931348623157E308"/>
                            </VBox>
                        </VBox>

                        <!-- Sponsors -->
                        <VBox spacing="6">
                            <Button fx:id="sponsorsBtn" text="Sponsors"
                                    styleClass="main-menu-button"
                                    onAction="#toggleSponsors" maxWidth="1.7976931348623157E308">
                                <graphic>
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Text styleClass="menu-icon" text="ðŸ’¼"/>
                                        <Text fx:id="sponsorsArrow" styleClass="menu-arrow" text="â–¼"/>
                                    </HBox>
                                </graphic>
                            </Button>

                            <VBox fx:id="sponsorsSubmenu" visible="true" managed="true" spacing="6">
                                <Button fx:id="sponsorsListBtn" text="   Admin Sponsors"
                                        styleClass="submenu-button" onAction="#onSponsorsList"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="sponsorPortalBtn" text="   Portail Sponsor"
                                        styleClass="submenu-button" onAction="#onSponsorPortal"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="budgetBtn" text="   Budget"
                                        styleClass="submenu-button" onAction="#onBudget"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="contratsBtn" text="   DÃ©penses"
                                        styleClass="submenu-button" onAction="#onDepenses"
                                        maxWidth="1.7976931348623157E308"/>
                            </VBox>
                        </VBox>

                        <!-- Ressources -->
                        <VBox spacing="6">
                            <Button fx:id="resourcesToggleBtn" text="Ressources"
                                    styleClass="main-menu-button"
                                    onAction="#toggleResources" maxWidth="1.7976931348623157E308">
                                <graphic>
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Text styleClass="menu-icon" text="ðŸ¢"/>
                                        <Text fx:id="resourcesArrow" styleClass="menu-arrow" text="â–¶"/>
                                    </HBox>
                                </graphic>
                            </Button>

                            <VBox fx:id="resourcesSubmenu" visible="false" managed="false" spacing="6">
                                <Button fx:id="sallesBtn" text="   Salles"
                                        styleClass="submenu-button" onAction="#onSalles"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="equipementsBtn" text="   Ã‰quipements"
                                        styleClass="submenu-button" onAction="#onEquipements"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="reservationsBtn" text="   RÃ©servations"
                                        styleClass="submenu-button" onAction="#onReservations"
                                        maxWidth="1.7976931348623157E308"/>
                            </VBox>
                        </VBox>

                        <!-- Questionnaires -->
                        <VBox spacing="6">
                            <Button fx:id="questionnairesToggleBtn" text="Questionnaires"
                                    styleClass="main-menu-button"
                                    onAction="#toggleQuestionnaires" maxWidth="1.7976931348623157E308">
                                <graphic>
                                    <HBox alignment="CENTER_LEFT" spacing="10">
                                        <Text styleClass="menu-icon" text="ðŸ“"/>
                                        <Text fx:id="questionnairesArrow" styleClass="menu-arrow" text="â–¶"/>
                                    </HBox>
                                </graphic>
                            </Button>

                            <VBox fx:id="questionnairesSubmenu" visible="false" managed="false" spacing="6">
                                <Button fx:id="questionsBtn" text="   Questions"
                                        styleClass="submenu-button" onAction="#onQuestions"
                                        maxWidth="1.7976931348623157E308"/>
                                <Button fx:id="reponsesBtn" text="   RÃ©ponses"
                                        styleClass="submenu-button" onAction="#onReponses"
                                        maxWidth="1.7976931348623157E308"/>
                            </VBox>
                        </VBox>

                        <!-- ParamÃ¨tres -->
                        <Button fx:id="settingsBtn" text="ParamÃ¨tres"
                                styleClass="main-menu-button"
                                onAction="#showSettings" maxWidth="1.7976931348623157E308">
                            <graphic><Text styleClass="menu-icon" text="âš™"/></graphic>
                        </Button>

                    </VBox>
                </content>
            </ScrollPane>

            <!-- Bottom -->
            <VBox styleClass="sidebar-bottom">
                <Button fx:id="logoutBtn" text="DÃ©connexion"
                        styleClass="logout-button"
                        onAction="#logout" maxWidth="1.7976931348623157E308"/>
            </VBox>
        </VBox>

        <!-- CONTENU DROITE -->
        <VBox spacing="0" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">

            <!-- TOP BAR -->
            <HBox alignment="CENTER_LEFT" prefHeight="64" styleClass="topbar">

                <TextField promptText="Recherche globale..."
                           styleClass="topbar-search"/>

                <Region HBox.hgrow="ALWAYS"/>

                <VBox alignment="CENTER_RIGHT" spacing="0">
                    <Label fx:id="navDateLabel" styleClass="topbar-date"/>
                    <Label fx:id="navTimeLabel" styleClass="topbar-time"/>
                </VBox>

                <MenuButton fx:id="profileMenu" styleClass="topbar-profile">
                    <graphic>
                        <HBox alignment="CENTER" spacing="10">
                            <StackPane fx:id="avatarContainer" alignment="CENTER">
                                <Circle radius="18" fill="rgba(255,255,255,0.25)"/>
                                <Circle radius="16" fill="white"/>
                                <ImageView fx:id="profileImageView" fitHeight="28" fitWidth="28" preserveRatio="true" visible="false">
                                    <clip><Circle centerX="14" centerY="14" radius="14"/></clip>
                                </ImageView>
                                <StackPane fx:id="initialsContainer" visible="true">
                                    <Circle radius="14" fill="#1565C0"/>
                                    <Text fx:id="userInitialsText" text="MM" style="-fx-font-size: 12px; -fx-font-weight: bold; -fx-fill: white;"/>
                                </StackPane>
                            </StackPane>

                            <VBox alignment="CENTER_LEFT" spacing="0">
                                <Label fx:id="userNameLabel" text="Maryem Manai" styleClass="topbar-username"/>
                                <Label fx:id="userRoleLabel" text="Sponsor" styleClass="topbar-role"/>
                            </VBox>

                            <Text text="â–¼" style="-fx-fill: white; -fx-font-size: 10px;"/>
                        </HBox>
                    </graphic>
                    <items>
                        <MenuItem text="ðŸ‘¤ Mon Profil" onAction="#showProfile"/>
                        <MenuItem text="âš™ï¸ ParamÃ¨tres" onAction="#showSettings"/>
                        <SeparatorMenuItem/>
                        <MenuItem text="ðŸšª DÃ©connexion" onAction="#logout"/>
                    </items>
                </MenuButton>

            </HBox>

            <!-- ZONE CENTRALE -->
            <VBox fx:id="pageContentContainer"
                  style="-fx-background-color: #f8fafc; -fx-padding: 20;"
                  VBox.vgrow="ALWAYS"/>
        </VBox>

    </HBox>
</StackPane>